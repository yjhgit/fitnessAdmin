{"remainingRequest":"A:\\project\\java\\lxgym\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!A:\\project\\java\\lxgym\\src\\main\\resources\\front\\front\\src\\pages\\shop-cart\\list.vue?vue&type=script&lang=js&","dependencies":[{"path":"A:\\project\\java\\lxgym\\src\\main\\resources\\front\\front\\src\\pages\\shop-cart\\list.vue","mtime":1678095437000},{"path":"A:\\project\\java\\lxgym\\src\\main\\resources\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"A:\\project\\java\\lxgym\\src\\main\\resources\\front\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"A:\\project\\java\\lxgym\\src\\main\\resources\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"A:\\project\\java\\lxgym\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBjb25maWcgZnJvbSAnQC9jb25maWcvY29uZmlnJwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGJhc2VVcmw6IGNvbmZpZy5iYXNlVXJsLAogICAgICB0YWJsZURhdGE6IFtdLAogICAgICBzZWxSb3dzOltdCiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRDYXJ0TGlzdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKGUpewogICAgICAgIHRoaXMuc2VsUm93cyA9IGUKICAgIH0sCiAgICBnZXRDYXJ0TGlzdCgpIHsKICAgICAgdGhpcy4kaHR0cC5nZXQoJ2NhcnQvbGlzdCcsIHtwYXJhbXM6IHtwYWdlOiAxLCBsaW1pdDogMTAwMCwgdXNlcmlkOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcmlkJyl9fSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDApIHsKICAgICAgICAgIHRoaXMudGFibGVEYXRhID0gcmVzLmRhdGEuZGF0YS5saXN0OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlQ2hhbmdlKHZhbHVlLCBpbmRleCwgcm93KSB7CiAgICAgIHRoaXMuJGh0dHAuZ2V0KGAke3Jvdy50YWJsZW5hbWV9L2RldGFpbC8ke3Jvdy5nb29kaWR9YCkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDAgJiYgdmFsdWUgPiByZXMuZGF0YS5kYXRhLm9uZWxpbWl0dGltZXMpIHsKICAgICAgICAgIHRoaXMudGFibGVEYXRhW2luZGV4XS5idXludW1iZXIgPSAtLXZhbHVlOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihg5q+P5Lq65Y2V5qyh5Y+q6IO96LSt5LmwJHtyZXMuZGF0YS5kYXRhLm9uZWxpbWl0dGltZXN95Lu2YCk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDAgJiYgdmFsdWUgPD0gcmVzLmRhdGEuZGF0YS5vbmVsaW1pdHRpbWVzKSB7CiAgICAgICAgICByb3cuYnV5bnVtYmVyID0gdmFsdWU7CiAgICAgICAgICB0aGlzLiRodHRwLnBvc3QoJ2NhcnQvdXBkYXRlJywgcm93KS50aGVuKHJlcyA9PiB7fSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVEZWxldGUoaW5kZXgsIHJvdykgewogICAgICB0aGlzLiRjb25maXJtKCfmmK/lkKbnoa7orqTliKDpmaQ/JywgJ+aPkOekuicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIGxldCBkZWxJZHMgPSBuZXcgQXJyYXkoKTsKICAgICAgICBkZWxJZHMucHVzaChyb3cuaWQpOwogICAgICAgIHRoaXMuJGh0dHAucG9zdCgnY2FydC9kZWxldGUnLCBkZWxJZHMpLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDApIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgIG1lc3NhZ2U6ICfliKDpmaTmiJDlip8hJywKICAgICAgICAgICAgICBkdXJhdGlvbjogMTUwMCwKICAgICAgICAgICAgICBvbkNsb3NlOiAoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmdldENhcnRMaXN0KCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgYnV5Q2xpY2soKSB7CiAgICAgIGlmKHRoaXMuc2VsUm93cy5sZW5ndGg9PTApIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJywKICAgICAgICAgICAgICBtZXNzYWdlOiAn6K+36YCJ5oup5ZWG5ZOBJywKICAgICAgICAgICAgICBkdXJhdGlvbjogMTUwMCwKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgdmFyIGduID0gIiI7CiAgICAgIGZvcihsZXQgeCBpbiB0aGlzLnNlbFJvd3MpewogICAgICAgICAgdmFyIGcgPSB0aGlzLnNlbFJvd3NbeF07CiAgICAgICAgICBjb25zb2xlLmxvZyhnLmdvb2RuYW1lKQogICAgICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICAgICAgdGhpcy4kaHR0cC5nZXQoYCR7Zy50YWJsZW5hbWV9L2RldGFpbC8ke2cuZ29vZGlkfWApLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT0gMCAmJiBnLmJ1eW51bWJlciA+IHJlcy5kYXRhLmRhdGEuYWxsbGltaXR0aW1lcykgewogICAgICAgICAgICAgIGduID0gZy5nb29kbmFtZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgIH0KICAgICAgCiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgaWYoZ249PSIiKSB7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ29yZGVyR29vZHMnLCBKU09OLnN0cmluZ2lmeSh0aGlzLnNlbFJvd3MpKTsKICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2luZGV4L3Nob3Atb3JkZXIvb3JkZXJDb25maXJtJyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZ24rYCDlupPlrZjkuI3otrNgKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgIH0sIDIwMCkKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICB0b3RhbFByaWNlKCkgewogICAgICAgICAgbGV0IHRvdGFsUHJpY2UgPSAwOwogICAgICAgICAgZm9yKGxldCB4IGluIHRoaXMuc2VsUm93cyl7CiAgICAgICAgICAgICAgICB0b3RhbFByaWNlICs9IE51bWJlcih0aGlzLnNlbFJvd3NbeF0ucHJpY2UpICogTnVtYmVyKHRoaXMuc2VsUm93c1t4XS5idXludW1iZXIpCiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdG90YWxQcmljZS50b0ZpeGVkKDIpOwogICAgfQogIH0KfQo="},{"version":3,"sources":["list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/pages/shop-cart","sourcesContent":["<template>\r\n<div :style='{\"width\":\"1000px\",\"padding\":\"20px\",\"margin\":\"10px auto\",\"position\":\"relative\",\"background\":\"#D8D8D8\"}'>\r\n    <div class=\"section-title\" :style='{\"margin\":\"10px 0\",\"fontSize\":\"20px\",\"lineHeight\":\"54px\",\"color\":\"#333\",\"textAlign\":\"center\",\"background\":\"#f5f5f5\"}'>购物车</div>\r\n    <el-table\r\n      @selection-change=\"handleSelectionChange\"\r\n      :data=\"tableData\"\r\n      style=\"width: 100%\">\r\n      <el-table-column type=\"selection\" width=\"50\" align=\"center\" />\r\n      <el-table-column\r\n        label=\"商品名称\">\r\n        <template slot-scope=\"scope\">\r\n          <div class=\"shangpin\">\r\n            <el-image\r\n              style=\"width: 100px; height: 100px\"\r\n              :src=\"baseUrl + scope.row.picture\"\r\n              fit=\"fill\"></el-image>\r\n            <span style=\"margin-left: 10px\">{{ scope.row.goodname }}</span>\r\n          </div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"价格\">\r\n        <template slot-scope=\"scope\">\r\n          <span :style='{\"fontSize\":\"12px\"}'>￥</span>{{ scope.row.price }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"数量\">\r\n        <template slot-scope=\"scope\">\r\n          <el-input-number :min=\"1\" v-model=\"scope.row.buynumber\" @change=\"(value) => handleChange(value, scope.$index, scope.row)\" size=\"small\"></el-input-number>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"总价\">\r\n        <template slot-scope=\"scope\">\r\n          <span :style='{\"fontSize\":\"12px\"}'>￥</span>{{ (scope.row.price * scope.row.buynumber).toFixed(2) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" width=\"150\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button\r\n            size=\"mini\"\r\n            type=\"danger\"\r\n            @click=\"handleDelete(scope.$index, scope.row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <div class=\"buy\" v-if=\"tableData.length > 0\">\r\n      <span style=\"color: red;margin-right: 10px;font-weight: 700;\">总价：<span :style='{\"fontSize\":\"12px\"}'>￥</span>{{totalPrice}}</span>\r\n      <el-button\r\n        type=\"warning\"\r\n        @click=\"buyClick\">点击购买</el-button>\r\n    </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\n  import config from '@/config/config'\r\n  export default {\r\n    data() {\r\n      return {\r\n        baseUrl: config.baseUrl,\r\n        tableData: [],\r\n        selRows:[]\r\n      }\r\n    },\r\n    created() {\r\n      this.getCartList();\r\n    },\r\n    methods: {\r\n      handleSelectionChange(e){\r\n          this.selRows = e\r\n      },\r\n      getCartList() {\r\n        this.$http.get('cart/list', {params: {page: 1, limit: 1000, userid: localStorage.getItem('userid')}}).then(res => {\r\n          if (res.data.code == 0) {\r\n            this.tableData = res.data.data.list;\r\n          }\r\n        });\r\n      },\r\n      handleChange(value, index, row) {\r\n        this.$http.get(`${row.tablename}/detail/${row.goodid}`).then(res => {\r\n          if (res.data.code == 0 && value > res.data.data.onelimittimes) {\r\n            this.tableData[index].buynumber = --value;\r\n            this.$message.error(`每人单次只能购买${res.data.data.onelimittimes}件`);\r\n          }\r\n          if (res.data.code == 0 && value <= res.data.data.onelimittimes) {\r\n            row.buynumber = value;\r\n            this.$http.post('cart/update', row).then(res => {});\r\n          }\r\n        });\r\n      },\r\n      handleDelete(index, row) {\r\n        this.$confirm('是否确认删除?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          let delIds = new Array();\r\n          delIds.push(row.id);\r\n          this.$http.post('cart/delete', delIds).then(res => {\r\n            if (res.data.code == 0) {\r\n              this.$message({\r\n                type: 'success',\r\n                message: '删除成功!',\r\n                duration: 1500,\r\n                onClose: () => {\r\n                  this.getCartList();\r\n                }\r\n              });\r\n            }\r\n          });\r\n        });\r\n      },\r\n      buyClick() {\r\n        if(this.selRows.length==0) {\r\n            this.$message({\r\n                type: 'warning',\r\n                message: '请选择商品',\r\n                duration: 1500,\r\n            });\r\n            return\r\n        }\r\n        var gn = \"\";\r\n        for(let x in this.selRows){\r\n            var g = this.selRows[x];\r\n            console.log(g.goodname)\r\n            let that = this;\r\n            this.$http.get(`${g.tablename}/detail/${g.goodid}`).then(res => {\r\n              if (res.data.code == 0 && g.buynumber > res.data.data.alllimittimes) {\r\n                gn = g.goodname;\r\n              }\r\n            });\r\n        }\r\n        \r\n        setTimeout(() => {\r\n            if(gn==\"\") {\r\n                localStorage.setItem('orderGoods', JSON.stringify(this.selRows));\r\n                this.$router.push('/index/shop-order/orderConfirm');\r\n            } else {\r\n                this.$message.error(gn+` 库存不足`);\r\n                return;\r\n            }\r\n        }, 200)\r\n      }\r\n    },\r\n    computed: {\r\n      totalPrice() {\r\n            let totalPrice = 0;\r\n            for(let x in this.selRows){\r\n                  totalPrice += Number(this.selRows[x].price) * Number(this.selRows[x].buynumber)\r\n            }\r\n            return totalPrice.toFixed(2);\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\r\n  .section {\r\n    width: 900px;\r\n    margin: 0 auto;\r\n  }\r\n\r\n  .shangpin {\r\n    display: flex;\r\n  }\r\n  .buy {\r\n    text-align: right;\r\n    padding-right: 82px;\r\n  }\r\n</style>\r\n"]}]}